
---

## نمای کلی پروژه

این پروژه یک محیط صنعتی را شبیه‌سازی می‌کند که در آن پارامترهای مختلف گاز و مکانیکی تولید می‌شود تا مدل‌هایی برای پیش‌بینی خرابی کمپرسورها و بلبرینگ‌ها در یک سیستم گاز آموزش داده شوند. کد به دو بخش اصلی تقسیم شده است: تولید داده و آموزش مدل.

### تولید داده

تابع تولید داده، `generate_realistic_industrial_data`، داده‌های مصنوعی را برای شبیه‌سازی اندازه‌گیری‌ها از یک سیستم گاز ایجاد می‌کند.

#### مؤلفه‌های کلیدی:

- **ایجاد زمان‌بندی**: یک ایندکس زمان‌بندی ایجاد می‌کند که از اول ژانویه ۲۰۲۳ شروع می‌شود و با تعداد رکوردهای مشخص شده (`n_records`) با فواصل یک دقیقه‌ای ادامه دارد.
  
- **تولید ویژگی‌های واقعی**:
  - **ورودی‌ها**:
    - `P_in`: فشار ورودی که از توزیع نرمال نمونه‌برداری شده و محدود به محدوده‌های واقعی می‌شود.
    - `T_in`: دمای ورودی که به‌طور مشابه نرمال شده است.
    - `Flow_in` و `Flow_out`: نرخ‌های جریان ورودی و خروجی که به‌طور مصنوعی با توزیع نرمال شبیه‌سازی می‌شوند تا تنوع‌های عملیاتی واقعی را شبیه‌سازی کنند.
    - **متغیرهای اضافی**: شامل لرزش، گشتاور، RPM، سطح صدا، ویسکوزیته و غلظت مولی که همگی داده‌های عملیاتی واقع‌گرایانه‌ای را ایجاد می‌کنند.
  
- **مهندسی ویژگی**: ویژگی‌های پیشرفته از متغیرهای اولیه ایجاد می‌شود:
  - `Pressure_flow_ratio`، `Energy_index` و `Viscosity_temperature` بینش‌هایی درباره عملکرد سیستم ارائه می‌دهند.
  - ویژگی‌های متکی بر زمان مانند `Vibration_ma_1h` و `Torque_ma_30min` متوسط متحرک را برای یک زمان معین ایجاد می‌کند تا بتوان روندها را تحلیل کرد.
  
- **محاسبات توان نظری و واقعی**: با استفاده از معادلات ترمودینامیکی، توان نظری محاسبه می‌شود و توان واقعی با اعمال فرمول کارایی که به چندین متغیر عملیاتی (مانند لرزش و ویسکوزیته) بستگی دارد، محاسبه می‌شود.

- **محاسبه شاخص سلامت**: یک نمره تجمیعی است که از چندین معیار عملیاتی برای نشان دادن وضعیت قطعات سیستم استخراج می‌شود.

- **تولید برچسب‌های خرابی**: با استفاده از یک مدل ریسک تعریف‌شده، برچسب‌هایی برای هر دو خرابی کمپرسور و بلبرینگ با توجه به ترکیب متغیرهای محاسبه‌شده ایجاد می‌شود.

### نمونه استفاده:
```python
industrial_data = generate_realistic_industrial_data()
print(industrial_data.head())
```

### آموزش مدل

بخش دوم پروژه شامل آماده‌سازی داده‌های تولید شده و آموزش مدل‌های یادگیری ماشین برای طبقه‌بندی خرابی‌های احتمالی در کمپرسورها و بلبرینگ‌ها است.

#### مؤلفه‌های کلیدی:

- **آماده‌سازی داده**:
  - داده‌های تولید شده به ویژگی‌ها (`X`) و برچسب‌ها (`y_compressor` و `y_bearing`) برای پیش‌بینی‌های مربوطه تقسیم می‌شود.
  - داده به مجموعه‌های آموزشی و آزمایشی تقسیم می‌شود با استفاده از `train_test_split`.

- **مقیاس‌گذاری ویژگی‌ها**: تمامی ویژگی‌ها استاندارد می‌شوند تا دقت و عملکرد مدل بهبود یابد.

- **ساخت مدل**:
  - **مدل خرابی کمپرسور**: یک شبکه عصبی ترتیبی با لایه‌هایی شامل Dense، BatchNormalization و Dropout برای منظم‌سازی ایجاد می‌شود. این مدل پیش‌بینی می‌کند که آیا یک کمپرسور دچار خرابی خواهد شد.
  
  ```python
  def build_compressor_model(input_shape):
      ...
  ```

  - **مدل خرابی بلبرینگ**: مشابه مدل کمپرسور است اما با تفاوت‌های جزئی در معماری و پیکربندی آموزشی.
  
  ```python
  def build_bearing_model(input_shape):
      ...
  ```

- **آموزش مدل**: هر دو مدل به‌طور جداگانه آموزش داده می‌شوند و از متد زیان باینری برای طبقه‌بندی و توقف زودهنگام برای جلوگیری از اضافه تطابق استفاده می‌شود.

- **ارزیابی مدل**:
  - توابع ارزیابی مقادیر مختلف عملکرد از جمله دقت، دقت مثبت و یادآوری را محاسبه کرده و نتایج را از طریق ماتریس‌های گیج و منحنی‌های ROC تجسم می‌کنند.
  
```python
def evaluate_classification(model, X_test, y_test, model_name):
    ...
```

### نمونه استفاده برای آموزش و ارزیابی مدل:
```python
X_train, X_test, yc_train, yc_test, yb_train, yb_test = train_test_split(
    X, y_compressor, y_bearing, test_size=0.3, random_state=42
)

compressor_model = build_compressor_model(X_train_scaled.shape[1])
history_compressor = compressor_model.fit(X_train_scaled, yc_train, ...)

evaluate_classification(compressor_model, X_test_scaled, yc_test, "Compressor Failure")


```


---
### نتیجه‌گیری

این کد یک پایه برای شبیه‌سازی داده‌های صنعتی و آموزش شبکه‌های عصبی برای پیش‌بینی نگهداری در سیستم‌های گاز فراهم می‌کند. کاربران می‌توانند پارامترها را در تابع تولید داده یا معماری‌های مدل تغییر دهند تا موارد استفاده خاصی را سازگار کنند. ترکیب تولید داده‌های واقع‌گرایانه و تکنیک‌های robust آموزش مدل، تجزیه و تحلیل پیشرفته‌ای را در عملیات صنعتی فراهم می‌کند.
# گزارش کد برای شبیه‌سازی داده‌های صنعتی و تشخیص ناهنجاری 

## مقدمه
این کد شامل دو بخش اصلی است:
1. **تولید داده‌ها**: تابعی که داده‌های شبیه‌سازی شده فرآیند صنعتی با ویژگی‌های مختلف را تولید می‌کند.
2. **تشخیص ناهنجاری**: کلاسی که سیستم تشخیص ناهنجاری را با استفاده از الگوریتم Isolation Forest پیاده‌سازی می‌کند.

## 1. تولید داده‌ها (`generate_industrial_data`)
تابع `generate_industrial_data` یک مجموعه داده شبیه‌سازی شده ایجاد می‌کند که ویژگی‌های زیر را دارد:

- **برچسب‌های زمانی**: یک ایندکس زمانی از تاریخ '2023-01-01' با فرکانس دقیقه‌ای تولید می‌شود.
- **ویژگی‌ها**: شبیه‌سازی پارامترهای مختلف صنعتی:
  - **P_in**: فشار ورودی، با توزیع نرمال و clipping به دامنه‌های واقعی.
  - **T_in**: دما ورودی، با توزیع نرمال و clipping.
  - **Flow_in و Flow_out**: نرخ جریان، با توزیع نرمال و غیرمنفی.
  - **Vibration، Torque، RPM، Sound، Viscosity**: معیارهای عملیاتی مختلف با توزیع‌های مختلف.
  - **ویژگی‌های مشتق‌شده**: متریک‌های اضافی محاسبه‌شده از ویژگی‌های اصلی، مانند:
    - نسبت فشار به جریان
    - شاخص انرژی
    - میانگین متحرک ارتعاش و گشتاور
    - محاسبات توان نظری و واقعی
    - شاخص سلامت بر اساس پارامترهای عملیاتی

- **برچسب‌های خرابی**: برچسب‌های دوسویه‌ای تولید می‌شوند که نشان‌دهنده خطر خرابی بر اساس عوامل ریسک ناشی از ویژگی‌ها می‌باشند، با استفاده از توزیع پواسون برای شبیه‌سازی خرابی‌های دوره‌ای.

- **مدیریت مقادیر گمشده**: تابع مقادیر NaN را با استفاده از روش backward fill پر می‌کند تا از وجود داده‌های گمشده در DataFrame نهایی جلوگیری کند.

## 2. کلاس تشخیص ناهنجاری (`AnomalyDetector`)
کلاس `AnomalyDetector` برای شناسایی ناهنجاری‌ها در داده‌های تولیدشده طراحی شده است. اجزای کلیدی آن عبارتند از:

- **راه‌اندازی**: یک DataFrame و پارامتر آلودگی (نسبت مورد انتظار ناهنجاری‌ها) را می‌گیرد و مدل Isolation Forest را راه‌اندازی می‌کند.

- **پیش‌پردازش داده‌ها**:
  - حذف ستون‌های غیرعددی مربوط به برچسب‌های خرابی.
  - پر کردن مقادیر گمشده با استفاده از fill forward.
  - مقیاس‌بندی ویژگی‌ها با استفاده از `StandardScaler`.

- **تشخیص ناهنجاری**:
  - مدل Isolation Forest را به داده‌های مقیاس‌بندی‌شده فیت می‌کند.
  - ناهنجاری‌ها را پیش‌بینی کرده و در DataFrame اصلی علامت‌گذاری می‌کند.

- **بازیابی ناهنجاری**: متدی برای بازیابی ردیف‌هایی که به‌عنوان ناهنجاری شناخته شده‌اند ارائه می‌دهد.

- **تصویرسازی**: متدی برای ترسیم ناهنجاری‌ها نسبت به دو ویژگی مشخص شده، امکان بازبینی بصری ناهنجاری‌های شناسایی‌شده را فراهم می‌آورد.

- **مقاومت مدل**: متدهایی برای ذخیره و بارگذاری مدل آموزش دیده و مقیاس‌گر با استفاده از `joblib` پیاده‌سازی شده است، که استفاده مجدد از مدل را بدون نیاز به آموزش مجدد تسهیل می‌کند.

## مثال از استفاده
در انتهای کد، یک مثال از نحوه استفاده ارائه شده است:
1. تولید داده‌های صنعتی شبیه‌سازی شده.
2. راه‌اندازی `AnomalyDetector` با داده‌های تولید شده.
3. پیش‌پردازش داده‌ها، تشخیص ناهنجاری و تصویرسازی نتایج.
4. ذخیره مدل و مقیاس‌گر برای استفاده‌های آتی.

## نکات مهم
- **عملکرد**: تولید داده‌های شبیه‌سازی شده ممکن است به منابع زیادی نیاز داشته باشد به‌خصوص با تعداد زیاد رکوردها (۱۰ میلیون). برای تست، کاهش تعداد رکوردها پیشنهاد می‌شود.
- **تنظیم پارامتر**: پارامتر آلودگی و سایر هایپرپارامترهای مدل می‌توانند بر اساس ویژگی‌های واقعی داده تنظیم شوند.
- **مهندسی ویژگی**: انتخاب ویژگی‌ها و تغییرات آن‌ها می‌تواند تاثیر قابل توجهی بر عملکرد تشخیص ناهنجاری داشته باشد. بررسی بیشتر اهمیت ویژگی‌ها می‌تواند مفید باشد.

## نتیجه‌گیری
این کد یک چارچوب جامعی برای شبیه‌سازی داده‌های صنعتی و تشخیص ناهنجاری با استفاده از تکنیک‌های یادگیری ماشین فراهم می‌آورد. این کد می‌تواند به عنوان یک بنیاد برای تحلیلات پیچیده‌تر و کاربردهای عملی در نگهداری پیشگیرانه و تشخیص نقص‌های فنی استفاده شود. اگر به جزئیات بیشتری در مورد بخش‌های خاص یا هر سوال دیگری نیاز دارید، لطفاً بپرسید!

---

---

# گزارش کد برای شبیه‌سازی داده‌های صنعتی و تحلیل سیستم‌های گازی

## مقدمه
این کد شامل تولید داده‌های صنعتی واقعی و تحلیل سیستم‌های گازی با استفاده از روش‌های مختلف مدل‌سازی و یادگیری ماشین است. این کد شامل تولید داده‌های شبیه‌سازی شده، تحلیل خواص ترمودینامیکی، حل معادلات ناپایستگی و تحلیل ارتعاشات می‌باشد.

## 1. تولید داده‌های صنعتی واقعی (`generate_realistic_industrial_data`)
تابع `generate_realistic_industrial_data` یک مجموعه داده شبیه‌سازی شده با ویژگی‌های زیر تولید می‌کند:

- **برچسب‌های زمانی**: ایجاد یک ایندکس زمانی برای تحلیل سری‌های زمانی.
- **ویژگی‌های پایه**: شامل فشار ورودی (`P_in`)، دما ورودی (`T_in`)، فشار خروجی (`P_OUT`)، دما خروجی (`T_OUT`) و سایر ویژگی‌های عملیاتی.
- **محاسبات پیشرفته**: شامل نسبت‌های فشار و دما، محاسبات توان نظری و واقعی، و شاخص سلامت.
- **برچسب‌های خرابی**: تولید برچسب‌های خرابی بر اساس شرایط واقعی و نویز.

این تابع داده‌ها را در یک DataFrame ذخیره کرده و مقادیر گمشده را با استفاده از روش `backfill` پر می‌کند.

## 2. تحلیل سیستم گاز (`GasSystemAnalyzer`)
کلاس `GasSystemAnalyzer` برای محاسبه خواص ترمودینامیکی و هیدرودینامیکی طراحی شده است. اجزای کلیدی آن عبارتند از:

- **محاسبات خواص ترمودینامیکی**:
  - محاسبه سرعت جریان، عدد رینولدز، عدد ماخ و ضریب تراکم‌پذیری.
  
این کلاس می‌تواند به تحلیل رفتار گاز در سیستم‌های مختلف کمک کند.

## 3. حل معادلات ناپایستگی (`NavierStokesSolver`)
کلاس `NavierStokesSolver` برای حل معادلات ناپایستگی طراحی شده است. این کلاس شامل متدهای زیر است:

- **حل معادله جرم-فنر**: برای تحلیل ارتعاشات.
- **حل معادله ناپایستگی یک بعدی**: برای تحلیل جریان گاز.

این کلاس به تحلیل رفتار دینامیکی سیستم‌ها کمک می‌کند.

## 4. تحلیل ارتعاشات و یادگیری ماشین
- **تحلیل ارتعاشات**: با استفاده از معادله جرم-فنر، نتایج شبیه‌سازی ارتعاشات به تصویر کشیده می‌شود.
- **مدل‌سازی یادگیری ماشین**: استفاده از رگرسیون خطی برای پیش‌بینی برچسب‌های خرابی بر اساس ویژگی‌های مختلف.

### مثال از استفاده
در انتهای کد، یک مثال از نحوه استفاده از کلاس‌ها و توابع ارائه شده است:
1. تولید داده‌های صنعتی واقعی.
2. محاسبه خواص ترمودینامیکی.
3. حل معادلات ناپایستگی و تحلیل ارتعاشات.
4. مدل‌سازی و پیش‌بینی با استفاده از رگرسیون خطی.

## نتیجه‌گیری
این کد یک چارچوب جامع برای شبیه‌سازی داده‌های صنعتی و تحلیل سیستم‌های گازی با استفاده از تکنیک‌های مختلف یادگیری ماشین و مدل‌سازی فراهم می‌آورد. این کد می‌تواند به عنوان یک بنیاد برای تحلیل‌های پیچیده‌تر و کاربردهای عملی در مهندسی شیمی و مکانیک سیالات استفاده شود. اگر به جزئیات بیشتری در مورد بخش‌های خاص یا هر سوال دیگری نیاز دارید، لطفاً بپرسید!

---







### مجوز

این پروژه تحت مجوز MIT مجاز است. برای جزئیات بیشتر به فایل LICENSE مراجعه کنید.

---
